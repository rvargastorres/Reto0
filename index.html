<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Descubre Tu Potencial con IA - Quiz Evaluativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f8fafc;
            transition: all 0.3s ease;
        }
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .radio-btn:checked + label {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .checkbox-btn:checked + label {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .progress-dot.completed {
            background-color: #3b82f6;
            transform: scale(1.2);
        }
        .progress-dot.active {
            background-color: #93c5fd;
            transform: scale(1.1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="w-full max-w-3xl bg-white rounded-lg shadow-md overflow-hidden">
        <!-- Header with Progress Bar -->
        <div class="bg-gradient-to-r from-blue-500 to-teal-500 p-6 text-white">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-2xl font-bold">Descubre Tu Potencial con IA</h1>
                <span id="progress-text" class="font-semibold text-blue-100">Pregunta 1 de 10</span>
            </div>
            <div class="flex justify-center items-center mt-4 space-x-4" id="progress-dots-container">
                <!-- Progress dots will be added by JavaScript -->
            </div>
        </div>

        <div id="quiz-container" class="p-6 sm:p-8">
            <!-- Welcome Screen -->
            <div id="welcome-screen" class="text-center fade-in">
                <div class="mb-8">
                    <img src="https://cdn-icons-png.flaticon.com/512/2210/2210153.png" alt="AI Icon" class="w-20 h-20 mx-auto mb-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">¬°Bienvenido al Quiz de IA!</h2>
                    <p class="text-gray-600 mb-6">Este cuestionario evaluar√° tu perfil, conocimientos de Inteligencia Artificial y metas financieras para crear un plan de aprendizaje personalizado.</p>
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-left my-6 rounded">
                        <p class="text-blue-700">üí° Solo te tomar√° <span class="font-bold">3 minutos</span> completarlo y al final recibir√°s recomendaciones espec√≠ficas para potenciar tu carrera con IA.</p>
                    </div>
                </div>
                <button onclick="startQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    COMENZAR QUIZ
                </button>
            </div>

            <!-- Questions will be dynamically inserted here -->
            <div id="questions-container" class="hidden">
                <form id="quiz-form">
                    <!-- Questions will be added dynamically by JavaScript -->
                </form>
            </div>

            <!-- Results Screen -->
            <div id="results-screen" class="hidden fade-in">
                <div class="text-center mb-8">
                    <img src="https://cdn-icons-png.flaticon.com/512/3179/3179068.png" alt="Success Icon" class="w-20 h-20 mx-auto mb-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">¬°Resultados Listos!</h2>
                    <p class="text-gray-600 mb-6">Hemos creado un plan personalizado seg√∫n tus respuestas.</p>
                </div>

                <div id="personalized-results" class="bg-blue-50 rounded-lg p-6 mb-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-user-tie mr-2 text-blue-600"></i> Tu Perfil
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="text-blue-600 mb-2"><i class="fas fa-layer-group"></i></div>
                            <h4 class="font-bold text-gray-700">Nivel de IA</h4>
                            <p id="result-level" class="text-gray-600 text-sm">Principiante</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="text-blue-600 mb-2"><i class="fas fa-bullseye"></i></div>
                            <h4 class="font-bold text-gray-700">Enfoque Principal</h4>
                            <p id="result-focus" class="text-gray-600 text-sm">Marketing Digital</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="text-blue-600 mb-2"><i class="fas fa-calendar-check"></i></div>
                            <h4 class="font-bold text-gray-700">Duraci√≥n Recomendada</h4>
                            <p id="result-duration" class="text-gray-600 text-sm">4 semanas</p>
                        </div>
                    </div>

                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-map-marked-alt mr-2 text-blue-600"></i> Plan de Aprendizaje
                    </h3>
                    <div id="learning-plan" class="space-y-4">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>

                <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                    <button onclick="window.print()" class="bg-white hover:bg-gray-100 text-blue-600 font-semibold py-3 px-6 border border-blue-400 rounded-lg transition duration-300 flex items-center justify-center">
                        <i class="fas fa-file-pdf mr-2"></i> Exportar a PDF
                    </button>
                    <button onclick="window.location.href='mailto:?subject=Mi Plan de Aprendizaje de IA&body=Comparto contigo mi plan de aprendizaje personalizado de IA.'" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 flex items-center justify-center">
                        <i class="fas fa-envelope mr-2"></i> Enviar por Email
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Quiz Questions Data
        const questions = [
            // Section 1: Demographic Data
            {
                id: 1,
                section: "Datos Demogr√°ficos",
                title: "¬øCu√°l es tu edad?",
                type: "radio",
                options: [
                    { value: "under-25", label: "Menos de 25 a√±os", icon: "üë∂" },
                    { value: "25-35", label: "25 - 35 a√±os", icon: "üßë" },
                    { value: "36-45", label: "36 - 45 a√±os", icon: "üë®" },
                    { value: "46-plus", label: "46 a√±os o m√°s", icon: "üë¥" }
                ]
            },
            {
                id: 2,
                section: "Datos Demogr√°ficos",
                title: "¬øCu√°l es tu g√©nero?",
                type: "radio",
                options: [
                    { value: "female", label: "Femenino", icon: "üë©" },
                    { value: "male", label: "Masculino", icon: "üë®" },
                    { value: "other", label: "Otro/Prefiero no decir", icon: "üßë" }
                ]
            },
            {
                id: 3,
                section: "Datos Demogr√°ficos",
                title: "¬øCu√°l es tu situaci√≥n laboral actual?",
                type: "radio",
                options: [
                    { value: "employed", label: "Empleado/a", icon: "üíº" },
                    { value: "self-employed", label: "Aut√≥nomo/a", icon: "üöÄ" },
                    { value: "student", label: "Estudiante", icon: "üéì" },
                    { value: "unemployed", label: "En b√∫squeda de empleo", icon: "üîç" }
                ]
            },
            
            // Section 2: Skills Assessment
            {
                id: 4,
                section: "Objetivos y Finanzas",
                title: "¬øCu√°l es su objetivo principal?",
                type: "radio",
                options: [
                    { value: "wealth", label: "Crecer en riqueza", icon: "üí∞" },
                    { value: "boss", label: "Ser mi propio jefe", icon: "üëî" },
                    { value: "freedom", label: "Libertad financiera", icon: "üèùÔ∏è" },
                    { value: "travel", label: "Viajar por el mundo", icon: "‚úàÔ∏è" },
                    { value: "career", label: "Crecimiento profesional", icon: "üìà" },
                    { value: "balance", label: "Equilibrio entre trabajo y vida", icon: "‚öñÔ∏è" }
                ]
            },
            {
                id: 5,
                section: "Objetivos y Finanzas", 
                title: "¬øCon qu√© fuente de ingresos est√° m√°s familiarizado?",
                type: "radio",
                options: [
                    { value: "full-time", label: "Trabajo a tiempo completo", icon: "üïí" },
                    { value: "passive", label: "Ingresos pasivos", icon: "üíµ" },
                    { value: "other-income", label: "Otro", icon: "‚ùì" }
                ]
            },
            {
                id: 6,
                section: "Objetivos y Finanzas",
                title: "¬øC√≥mo es su horario de trabajo?",
                type: "radio",
                options: [
                    { value: "9to5", label: "De 9 a 5", icon: "üëî" },
                    { value: "night", label: "Turnos nocturnos", icon: "üåô" },
                    { value: "flexible", label: "Horarios flexibles", icon: "‚è≥" },
                    { value: "retired", label: "Estoy jubilado", icon: "üë¥" }
                ]
            },
            {
                id: 7,
                section: "Desaf√≠os y Habilidades",
                title: "¬øCu√°les son los desaf√≠os con su trabajo actual?",
                type: "checkbox",
                options: [
                    { value: "underpaid", label: "Sentirse mal pagado", icon: "üí∏" },
                    { value: "dependent", label: "Dependencia financiera", icon: "‚õìÔ∏è" },
                    { value: "no-time", label: "Falta de tiempo libre", icon: "‚è∞" },
                    { value: "routine", label: "Rutina", icon: "üîÑ" },
                    { value: "stress", label: "Preocupaci√≥n constante", icon: "üòü" },
                    { value: "toxic", label: "Ambiente t√≥xico", icon: "‚ò†Ô∏è" },
                    { value: "other-challenges", label: "Otros", icon: "‚ùì" }
                ]
            },
            {
                id: 8,
                section: "Desaf√≠os y Habilidades",
                title: "¬øC√≥mo se siente acerca de su situaci√≥n financiera?",
                type: "radio",
                options: [
                    { value: "comfortable", label: "C√≥moda", icon: "üòä" },
                    { value: "needs-stability", label: "Me gustar√≠a tener m√°s estabilidad", icon: "üòê" },
                    { value: "struggling", label: "Estoy luchando para alcanzar mis metas financieras", icon: "üò£" }
                ]
            },
            {
                id: 9,
                section: "Desaf√≠os y Habilidades",
                title: "¬øCu√°l es su rango de ingresos anuales?",
                type: "radio",
                options: [
                    { value: "30-50k", label: "US$30,000 - US$50,000", icon: "üíµ" },
                    { value: "50-100k", label: "US$50,000 - US$100,000", icon: "üí∞" },
                    { value: "100k-plus", label: "M√°s de US$100,000", icon: "ü§ë" }
                ]
            },
            {
                id: 10,
                section: "Habilidades y Aspiraciones",
                title: "¬øDeseas tener m√°s control sobre sus horarios de trabajo y ubicaci√≥n?",
                type: "radio",
                options: [
                    { value: "yes-schedule", label: "Si", icon: "üëç" },
                    { value: "no-schedule", label: "No", icon: "üëé" },
                    { value: "unsure-schedule", label: "Hmm, no estoy seguro", icon: "ü§î" }
                ]
            },
            {
                id: 11,
                section: "Habilidades y Aspiraciones",
                title: "¬øDisfrutar√≠a un trabajo en el que las tareas rutinarias se hagan por usted?", 
                type: "radio",
                options: [
                    { value: "dream", label: "Es un sue√±o", icon: "‚ú®" },
                    { value: "somewhat", label: "En cierta medida", icon: "üòä" },
                    { value: "maybe", label: "Tal vez", icon: "ü§∑" },
                    { value: "not-need", label: "No necesariamente", icon: "üôÖ" }
                ]
            },
            {
                id: 12,
                section: "Habilidades y Aspiraciones",
                title: "¬øQu√© har√≠a con el tiempo que ahorrar√≠a al eliminar las tareas aburridas?",
                type: "radio",
                options: [
                    { value: "creative", label: "Dedicarme a pasiones creativas", icon: "üé®" },
                    { value: "relationships", label: "Relaciones profundas con seres queridos", icon: "üë™" },
                    { value: "growth", label: "Impulsar el crecimiento personal", icon: "üå±" },
                    { value: "health", label: "Priorizar la salud y el bienestar", icon: "üí™" }
                ]
            },
            {
                id: 13,
                section: "Habilidades y Aspiraciones",
                title: "¬øLe gustar√≠a un trabajo que coincida con sus intereses?",
                type: "radio",
                options: [
                    { value: "absolutely", label: "Absolutamente", icon: "üëç" },
                    { value: "somewhat-interest", label: "En cierta medida", icon: "üòê" },
                    { value: "maybe-interest", label: "Tal vez", icon: "ü§∑" },
                    { value: "not-necessary", label: "No necesariamente", icon: "üôÖ" }
                ]
            },
            {
                id: 14,
                section: "Habilidades Digitales",
                title: "¬øCu√°nto sabes sobre negocios digitales?",
                type: "radio",
                options: [
                    { value: "expert-digital", label: "Estoy bien informado al respecto", icon: "üèÜ" },
                    { value: "familiar-digital", label: "Estoy familiarizado con algunos aspectos", icon: "üìñ" },
                    { value: "limited-digital", label: "Mi conocimiento es limitado", icon: "üìâ" }
                ]
            },
            {
                id: 15,
                section: "Habilidades Digitales",
                title: "¬øHa explorado formas de ganar dinero adem√°s del trabajo regular?",
                type: "radio",
                options: [
                    { value: "side-jobs", label: "Si, trabajos paralelos ocasionales", icon: "üë®‚Äçüíª" },
                    { value: "regular-only", label: "No, solo un trabajo com√∫n", icon: "üë®‚Äçüè≠" },
                    { value: "freelance", label: "Trabaj√© como freelance", icon: "üñäÔ∏è" }
                ]
            },
            {
                id: 16, 
                section: "Habilidades Digitales",
                title: "¬øSe siente c√≥modo aprendiendo nuevas habilidades o t√©cnicas?",
                type: "radio",
                options: [
                    { value: "yes-learn", label: "Si", icon: "üëç" },
                    { value: "no-learn", label: "No", icon: "üëé" },
                    { value: "unsure-learn", label: "Hmm, no estoy seguro", icon: "ü§î" }
                ]
            },
            // Section 2: Skills Assessment
            {
                id: 17,
                section: "Diagn√≥stico de Habilidades",
                title: "¬øC√≥mo calificar√≠as tu conocimiento actual sobre IA?",
                type: "radio",
                options: [
                    { value: "beginner", label: "Principiante", description: "He o√≠do hablar de IA pero no la he usado", icon: "üå±" },
                    { value: "basic", label: "B√°sico", description: "He probado herramientas como ChatGPT", icon: "üî∞" },
                    { value: "intermediate", label: "Intermedio", description: "Uso IA regularmente en mi trabajo", icon: "üöÄ" },
                    { value: "advanced", label: "Avanzado", description: "Implemento soluciones de IA", icon: "üèÜ" }
                ]
            },
            {
                id: 26,
                section: "Diagn√≥stico de Habilidades",
                title: "¬øQu√© herramientas de IA conoces o has utilizado? (Puedes seleccionar varias)",
                type: "checkbox",
                options: [
                    { value: "chatgpt", label: "ChatGPT", icon: "üí¨", feedback: "¬°Excelente elecci√≥n! ChatGPT es fundamental para empezar con IA." },
                    { value: "midjourney", label: "MidJourney", icon: "üé®", feedback: "Genial para creativos que buscan generar im√°genes impresionantes." },
                    { value: "bard", label: "Google Bard", icon: "üîç", feedback: "Una alternativa potente a ChatGPT con integraci√≥n con Google." },
                    { value: "jasper", label: "Jasper", icon: "‚úçÔ∏è", feedback: "Perfecto para marketers y creadores de contenido." },
                    { value: "none", label: "Ninguna", icon: "‚ùì", feedback: "No hay problema, en tu plan incluiremos los fundamentos." },
                    { value: "other", label: "Otras", icon: "üîß", feedback: "Exploraremos herramientas similares en tu plan." }
                ]
            },
            {
                id: 27,
                section: "Diagn√≥stico de Habilidades",
                title: "¬øEn qu√© √°rea profesional te gustar√≠a aplicar la IA?",
                type: "radio",
                options: [
                    { value: "marketing", label: "Marketing Digital", icon: "üìà", followUp: true },
                    { value: "development", label: "Desarrollo de Software", icon: "üíª", followUp: true },
                    { value: "design", label: "Dise√±o", icon: "üé®", followUp: true },
                    { value: "data", label: "An√°lisis de Datos", icon: "üìä", followUp: true },
                    { value: "education", label: "Educaci√≥n", icon: "üìö", followUp: true },
                    { value: "other", label: "Otra", icon: "üîß" }
                ]
            },
            
            // Follow-up questions based on area of interest
            {
                id: 7,
                section: "Diagn√≥stico de Habilidades",
                title: "Para Marketing Digital: ¬øQu√© tipo de contenido necesitas generar con m√°s frecuencia?",
                type: "checkbox",
                conditional: "marketing",
                options: [
                    { value: "blogs", label: "Art√≠culos de blog", icon: "üìù" },
                    { value: "social", label: "Contenido para redes sociales", icon: "üì±" },
                    { value: "ads", label: "Copys para anuncios", icon: "üì¢" },
                    { value: "emails", label: "Emails de marketing", icon: "‚úâÔ∏è" },
                    { value: "video", label: "Guiones para video", icon: "üé•" }
                ]
            },
            {
                id: 8,
                section: "Diagn√≥stico de Habilidades",
                title: "Para Desarrollo de Software: ¬øEn qu√© lenguajes programas o te gustar√≠a programar?",
                type: "checkbox",
                conditional: "development",
                options: [
                    { value: "python", label: "Python", icon: "üêç" },
                    { value: "javascript", label: "JavaScript", icon: "üìú" },
                    { value: "java", label: "Java", icon: "‚òï" },
                    { value: "csharp", label: "C#", icon: "#Ô∏è‚É£" },
                    { value: "php", label: "PHP", icon: "üêò" },
                    { value: "other", label: "Otros", icon: "üîß" }
                ]
            },
            
            // Section 3: Goals and Challenges
            {
                id: 9,
                section: "Metas y Desaf√≠os",
                title: "¬øCu√°l es tu mayor reto profesional actual?",
                type: "radio",
                options: [
                    { value: "time", label: "Falta de tiempo", description: "Necesito optimizar mis procesos", icon: "‚è±Ô∏è" },
                    { value: "skills", label: "Falta de habilidades", description: "Necesito aprender nuevas tecnolog√≠as", icon: "üìö" },
                    { value: "clients", label: "Conseguir m√°s clientes", description: "Necesito escalar mi negocio", icon: "üë•" },
                    { value: "income", label: "Incrementar ingresos", description: "Quiero monetizar mejor mis habilidades", icon: "üí∞" },
                    { value: "competition", label: "Competencia", description: "Necesito diferenciarme", icon: "ü•ä" }
                ]
            },
            {
                id: 10,
                section: "Metas y Desaf√≠os",
                title: "¬øCu√°l es tu meta financiera con el uso de IA en los pr√≥ximos 6 meses?",
                type: "radio",
                options: [
                    { value: "save-time", label: "Ahorrar tiempo (equivalente a $)", icon: "‚è≥" },
                    { value: "side-income", label: "Generar ingresos secundarios", icon: "üí∏" },
                    { value: "main-income", label: "Convertirlo en mi principal ingreso", icon: "üè¶" },
                    { value: "scale-business", label: "Escalar mi negocio actual", icon: "üìà" },
                    { value: "not-sure", label: "A√∫n no estoy seguro", icon: "‚ùì" }
                ]
            }
        ];

        // Variables to track quiz state
        let currentQuestionIndex = 0;
        let answers = {};
        let followUps = {};
        let questionSequence = [];
        let previousAnswers = {};

        // Initialize the quiz
        function startQuiz() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('questions-container').classList.remove('hidden');
            
            // Create progress dots
            const dotsContainer = document.getElementById('progress-dots-container');
            dotsContainer.innerHTML = '';
            
            // Only show dots for non-conditional questions
            const visibleQuestions = questions.filter(q => !q.conditional);
            for (let i = 0; i < visibleQuestions.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot w-3 h-3 rounded-full bg-gray-300 transition';
                if (i === 0) dot.classList.add('active');
                dotsContainer.appendChild(dot);
            }
            
            // Build the sequence of questions (first demographic questions)
            // Update IDs to account for new questions being inserted before original ones
            questionSequence = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25];
            
            // Load the first question
            loadQuestion(0);
        }

        // Load a question into the DOM
        function loadQuestion(index) {
            const question = questions[questionSequence[index]];
            const form = document.getElementById('quiz-form');
            
            // Update progress text
            document.getElementById('progress-text').textContent = `Pregunta ${index + 1} de ${questionSequence.length}`;
            
            // Update progress dots
            const dots = document.querySelectorAll('.progress-dot');
            dots.forEach((dot, i) => {
                dot.classList.remove('active', 'completed');
                if (i < currentQuestionIndex) {
                    dot.classList.add('completed');
                } else if (i === currentQuestionIndex) {
                    dot.classList.add('active');
                }
            });
            
            // Create question HTML
            form.innerHTML = `
                <div class="question-container fade-in">
                    <h3 class="text-sm font-semibold text-blue-600 mb-1">${question.section}</h3>
                    <h2 class="text-xl font-bold text-gray-800 mb-6">${question.title}</h2>
                    
                    <div class="space-y-4 mb-8">
                        ${question.options.map(option => {
                            if (question.type === 'radio') {
                                return `
                                <div class="relative">
                                    <input type="radio" id="${question.id}-${option.value}" name="question-${question.id}" value="${option.value}" class="hidden radio-btn" ${answers[question.id] === option.value ? 'checked' : ''}>
                                    <label for="${question.id}-${option.value}" class="block p-4 border rounded-lg cursor-pointer transition hover:border-blue-300 ${answers[question.id] === option.value ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}">
                                        <div class="flex items-center">
                                            <span class="text-xl mr-3">${option.icon || 'üîò'}</span>
                                            <div>
                                                <p class="font-medium">${option.label}</p>
                                                ${option.description ? `<p class="text-sm text-gray-500 mt-1">${option.description}</p>` : ''}
                                            </div>
                                        </div>
                                    </label>
                                </div>
                                `;
                            } else { // checkbox
                                return `
                                <div class="relative">
                                    <input type="checkbox" id="${question.id}-${option.value}" name="${option.value}" value="${option.value}" class="hidden checkbox-btn" ${answers[question.id] && answers[question.id].includes(option.value) ? 'checked' : ''}>
                                    <label for="${question.id}-${option.value}" class="block p-4 border rounded-lg cursor-pointer transition hover:border-blue-300 ${answers[question.id] && answers[question.id].includes(option.value) ? 'border-blue-500 bg-blue-50' : 'border-gray-200'}">
                                        <div class="flex items-center">
                                            <span class="text-xl mr-3">${option.icon || '‚úÖ'}</span>
                                            <div>
                                                <p class="font-medium">${option.label}</p>
                                                ${option.description ? `<p class="text-sm text-gray-500 mt-1">${option.description}</p>` : ''}
                                            </div>
                                        </div>
                                    </label>
                                </div>
                                `;
                            }
                        }).join('')}
                    </div>
                    
                    <div class="flex justify-between">
                        ${index > 0 ? `
                            <button type="button" onclick="previousQuestion()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg transition">
                                Atr√°s
                            </button>
                        ` : `<div></div>`}
                        
                        <button type="button" onclick="nextQuestion()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition ${answers[question.id] ? '' : 'opacity-50 cursor-not-allowed'}" ${answers[question.id] ? '' : 'disabled'}>
                            ${index < questionSequence.length - 1 ? 'Continuar' : 'Ver resultados'}
                        </button>
                    </div>
                </div>
            `;
            
            // Update current question index
            currentQuestionIndex = index;
        }

        // Handle next question
        function nextQuestion() {
            const currentQuestion = questions[questionSequence[currentQuestionIndex]];
            const form = document.getElementById('quiz-form');
            const inputs = form.querySelectorAll('input[type="radio"], input[type="checkbox"]:checked');
            
            // Validate response
            if (inputs.length === 0 && currentQuestion.type === 'radio') {
                alert('Por favor selecciona una opci√≥n para continuar.');
                return;
            }
            
            // Save answer
            saveAnswer(currentQuestion);
            
            // Check for conditional questions to add to sequence
            if (currentQuestion.type === 'radio' && currentQuestion.followUp) {
                addConditionalQuestions(currentQuestion.id);
            }
            
            // Move to next question or show results
            if (currentQuestionIndex < questionSequence.length - 1) {
                loadQuestion(currentQuestionIndex + 1);
            } else {
                showResults();
            }
        }

        // Handle previous question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                loadQuestion(currentQuestionIndex - 1);
            }
        }

        // Save answer to answers object
        function saveAnswer(question) {
            const form = document.getElementById('quiz-form');
            
            if (question.type === 'radio') {
                const selected = form.querySelector('input[type="radio"]:checked');
                if (selected) {
                    answers[question.id] = selected.value;
                    previousAnswers[question.id] = selected.value;
                    
                    // If this was a conditional question that triggered follow-ups,
                    // remove the follow-ups if the answer changes
                    if (followUps[question.id]) {
                        delete followUps[question.id];
                        rebuildQuestionSequence();
                    }
                }
            } else { // checkbox
                const selected = Array.from(form.querySelectorAll('input[type="checkbox"]:checked')).map(el => el.value);
                if (selected.length > 0) {
                    answers[question.id] = selected;
                }
            }
        }

        // Add conditional questions based on previous answers
        function addConditionalQuestions(questionId) {
            const answer = answers[questionId];
            const conditionalQuestions = questions.filter(q => q.conditional === answer);
            
            if (conditionalQuestions.length > 0) {
                followUps[questionId] = conditionalQuestions.map(q => questions.indexOf(q));
                rebuildQuestionSequence();
            }
        }

        // Rebuild question sequence based on demographics and follow-ups
        function rebuildQuestionSequence() {
            // Start with the 3 demographic questions
            questionSequence = [0, 1, 2];
            
            // Add all non-conditional questions after demographics
            questions.slice(3).forEach((q, i) => {
                if (!q.conditional) {
                    questionSequence.push(i + 3);
                }
            });
            
            // Add follow-up questions after their trigger question
            for (const [triggerId, followUpIndexes] of Object.entries(followUps)) {
                const triggerIndex = questions.findIndex(q => q.id == triggerId);
                
                // Find position of trigger in current sequence
                const triggerPos = questionSequence.indexOf(triggerIndex);
                
                // Insert follow-ups right after the trigger
                if (triggerPos !== -1) {
                    questionSequence.splice(triggerPos + 1, 0, ...followUpIndexes);
                }
            }
        }

        // Show the results screen
        function showResults() {
            document.getElementById('questions-container').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');
            
            // Determine the user's level
            const skillAnswer = answers[4]; // Question ID 4 is about skill level
            let skillLevel = "Principiante";
            if (skillAnswer === "basic") skillLevel = "B√°sico";
            else if (skillAnswer === "intermediate") skillLevel = "Intermedio";
            else if (skillAnswer === "advanced") skillLevel = "Avanzado";
            
            // Determine focus area
            let focusArea = "General";
            if (answers[6]) {
                const areaQuestion = questions[5]; // Question ID 6 is about focus area
                const selectedOption = areaQuestion.options.find(opt => opt.value === answers[6]);
                focusArea = selectedOption.label;
            }
            
            // Generate learning plan
            const learningPlanElement = document.getElementById('learning-plan');
            let planSteps = [];
            
            // Step 1: Fundamentals based on skill level
            if (skillAnswer === "beginner" || skillAnswer === "basic") {
                planSteps.push({
                    icon: "üìö", 
                    title: "Fundamentos de IA", 
                    description: "Comprende los conceptos b√°sicos de inteligencia artificial y c√≥mo se aplica en diferentes industrias.",
                    resources: ["Curso introductorio de IA (3 horas)", "Glosario de t√©rminos clave"]
                });
            }
            
            // Step 2: Tools based on selected tools
            if (answers[5]) {
                const toolNames = answers[5].map(val => {
                    const toolQuestion = questions[4];
                    const toolOption = toolQuestion.options.find(opt => opt.value === val);
                    return toolOption.label;
                });
                
                let toolResources = [];
                if (answers[5].includes("chatgpt")) {
                    toolResources.push("Gu√≠a avanzada de ChatGPT");
                }
                if (answers[5].includes("midjourney")) {
                    toolResources.push("Tutorial de creaci√≥n de im√°genes con MidJourney");
                }
                if (answers[5].includes("none")) {
                    toolResources = ["Introducci√≥n a ChatGPT", "Exploraci√≥n de herramientas b√°sicas"];
                }
                
                if (toolResources.length > 0) {
                    planSteps.push({
                        icon: "üõ†Ô∏è", 
                        title: "Herramientas de IA", 
                        description: `Dominio de ${toolNames.join(', ')} para aplicarlas en tus proyectos.`,
                        resources: toolResources
                    });
                }
            }
            
            // Step 3: Area-specific skills
            if (answers[6] && answers[6] !== "other") {
                let areaResources = [];
                if (answers[6] === "marketing") {
                    areaResources = ["IA para redacci√≥n de contenido", "Automatizaci√≥n de campa√±as", "Generaci√≥n de leads con IA"];
                    planSteps.push({
                        icon: "üìà", 
                        title: "Marketing con IA", 
                        description: "T√©cnicas avanzadas para aplicar IA en estrategias de marketing digital.",
                        resources: areaResources
                    });
                } else if (answers[6] === "development") {
                    areaResources = ["IA en desarrollo de software", "Code generation con GitHub Copilot", "Debugging con IA"];
                    planSteps.push({
                        icon: "üíª", 
                        title: "Desarrollo con IA", 
                        description: "C√≥mo implementar IA para acelerar tu flujo de trabajo en programaci√≥n.",
                        resources: areaResources
                    });
                }
            }
            
            // Step 4: Financial goals implementation
            if (answers[10]) {
                let goalPlan = [];
                if (answers[10] === "side-income") {
                    goalPlan = ["Plan de monetizaci√≥n con IA", "Ejemplos de negocios exitosos", "Estrategias de precios"];
                } else if (answers[10] === "scale-business") {
                    goalPlan = ["Automatizaci√≥n de procesos", "IA para atenci√≥n al cliente", "An√°lisis de datos para toma de decisiones"];
                }
                
                if (goalPlan.length > 0) {
                    planSteps.push({
                        icon: "üí∞", 
                        title: "Objetivos Financieros", 
                        description: "C√≥mo aplicar la IA para alcanzar tus metas de ingresos y crecimiento.",
                        resources: goalPlan
                    });
                }
            }
            
            // Default step if we don't have much info
            if (planSteps.length === 0) {
                planSteps.push({
                    icon: "üöÄ", 
                    title: "Introducci√≥n a la IA", 
                    description: "Recursos generales para comenzar tu viaje en inteligencia artificial.",
                    resources: ["Curso de introducci√≥n a la IA", "Lista de herramientas recomendadas"]
                });
            }
            
            // Add final step about community and support
            planSteps.push({
                icon: "üë•", 
                title: "Comunidad y Soporte", 
                description: "Acceso a nuestra comunidad de aprendizaje y sesiones de mentor√≠a.",
                resources: ["Grupo privado de Slack", "Webinars semanales", "Soporte 1:1"]
            });
            
            // Build the HTML for the learning plan
            learningPlanElement.innerHTML = planSteps.map(step => `
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
                    <div class="flex items-start mb-3">
                        <span class="text-2xl mr-3">${step.icon}</span>
                        <div>
                            <h4 class="font-bold text-gray-800">${step.title}</h4>
                            <p class="text-gray-600 text-sm">${step.description}</p>
                        </div>
                    </div>
                    <div class="border-t border-gray-100 pt-3">
                        <p class="text-xs font-semibold text-gray-500 uppercase mb-2">Recursos recomendados:</p>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            ${step.resources.map(resource => `<li>${resource}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `).join('');
            
            // Update the result summaries
            document.getElementById('result-level').textContent = skillLevel;
            document.getElementById('result-focus').textContent = focusArea;
            document.getElementById('result-duration').textContent = `${planSteps.length > 3 ? '8 semanas' : '4 semanas'}, 15-30 minutos diarios`;
        }

        // Set initial enabled state for next button when radio is selected
        document.addEventListener('change', function(e) {
            if (e.target.type === 'radio') {
                const btn = document.querySelector('button[onclick="nextQuestion()"]');
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                
                // Show feedback if available
                const currentQuestion = questions[questionSequence[currentQuestionIndex]];
                const selectedOption = currentQuestion.options.find(opt => opt.value === e.target.value);
                if (selectedOption && selectedOption.feedback) {
                    // Create or update feedback message
                    let feedbackEl = document.querySelector('.option-feedback');
                    if (!feedbackEl) {
                        feedbackEl = document.createElement('div');
                        feedbackEl.className = 'option-feedback bg-blue-50 border-l-4 border-blue-500 p-3 my-4 rounded text-blue-700 text-sm';
                        e.target.closest('.question-container').appendChild(feedbackEl);
                    }
                    feedbackEl.innerHTML = `<span class="font-semibold">${selectedOption.feedback}</span>`;
                    feedbackEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    // Remove feedback if switching to option without feedback
                    const feedbackEl = document.querySelector('.option-feedback');
                    if (feedbackEl) feedbackEl.remove();
                }
            }
        });
    </script>
</body>
</html>
